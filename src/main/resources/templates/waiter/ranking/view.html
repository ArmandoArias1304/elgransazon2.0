<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>El Gran Saz√≥n - Ranking de Meseros</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Work+Sans:wght@400;500;600;700;800&display=swap"
      rel="stylesheet"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght@300;400;500;600;700"
      rel="stylesheet"
    />
    
    <!-- Sistema de Temas (Modo Claro/Oscuro) -->
    <div th:replace="~{fragments/theme :: themeResources}"></div>
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <script>
      tailwind.config = {
        darkMode: "class",
        theme: {
          extend: {
            colors: {
              primary: "#38e07b",
              "primary-dark": "#2bc866",
              secondary: "#f59e0b",
              accent: "#3b82f6",
              "background-light": "#f8faf9",
              "background-dark": "#0f1323",
              "surface-light": "#ffffff",
              "surface-dark": "#1e293b",
              "text-light-primary": "#0f172a",
              "text-light-secondary": "#64748b",
              "text-dark-primary": "#f8fafc",
              "text-dark-secondary": "#94a3b8",
            },
            fontFamily: {
              display: ["Work Sans"],
            },
            borderRadius: {
              DEFAULT: "0.5rem",
              lg: "0.75rem",
              xl: "1rem",
              "2xl": "1.5rem",
              full: "9999px",
            },
            boxShadow: {
              soft: "0 4px 6px -1px rgb(0 0 0 / 0.05), 0 2px 4px -2px rgb(0 0 0 / 0.05)",
              green: "0 4px 12px rgba(56, 224, 123, 0.3)",
              gold: "0 8px 24px rgba(251, 191, 36, 0.4)",
            },
          },
        },
      };
    </script>
    <style>
      .material-symbols-outlined {
        font-variation-settings: "FILL" 0, "wght" 400, "GRAD" 0, "opsz" 24;
      }
      .material-symbols-outlined.filled {
        font-variation-settings: "FILL" 1, "wght" 500;
      }

      @keyframes fadeInUp {
        from {
          opacity: 0;
          transform: translateY(20px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      @keyframes scaleIn {
        from {
          opacity: 0;
          transform: scale(0.8);
        }
        to {
          opacity: 1;
          transform: scale(1);
        }
      }

      @keyframes bounce {
        0%,
        100% {
          transform: translateY(0);
        }
        50% {
          transform: translateY(-10px);
        }
      }

      .animate-fadeInUp {
        animation: fadeInUp 0.6s ease-out;
      }

      .animate-scaleIn {
        animation: scaleIn 0.5s ease-out;
      }

      .crown-bounce {
        animation: bounce 2s ease-in-out infinite;
      }

      .ranking-item {
        transition: all 0.3s ease;
      }

      .ranking-item:hover {
        transform: translateX(8px);
        box-shadow: 0 10px 25px -5px rgb(0 0 0 / 0.1);
      }

      /* Custom Scrollbar */
      .overflow-y-auto::-webkit-scrollbar {
        width: 8px;
      }

      .overflow-y-auto::-webkit-scrollbar-track {
        background: #f1f5f9;
        border-radius: 10px;
      }

      .overflow-y-auto::-webkit-scrollbar-thumb {
        background: #cbd5e1;
        border-radius: 10px;
      }

      .overflow-y-auto::-webkit-scrollbar-thumb:hover {
        background: #94a3b8;
      }

      .dark .overflow-y-auto::-webkit-scrollbar-track {
        background: #1e293b;
      }

      .dark .overflow-y-auto::-webkit-scrollbar-thumb {
        background: #475569;
      }

      .dark .overflow-y-auto::-webkit-scrollbar-thumb:hover {
        background: #64748b;
      }
    </style>
  </head>
  <body
    class="bg-background-light dark:bg-background-dark font-display text-text-light-primary dark:text-dark-primary"
  >
    <div class="flex h-screen flex-col">
      <!-- Header -->
      <header
        class="flex items-center gap-3 border-b border-slate-200/80 dark:border-slate-800/80 bg-white dark:bg-surface-dark px-3 sm:px-6 py-3 sm:py-4 shadow-soft"
      >
        <!-- Back Button -->
        <a
          href="/waiter/dashboard"
          class="flex h-10 w-10 sm:h-11 sm:w-11 shrink-0 items-center justify-center rounded-xl bg-slate-100 text-slate-600 hover:bg-slate-200 dark:bg-slate-800 dark:text-slate-300 dark:hover:bg-slate-700 transition-colors"
        >
          <span class="material-symbols-outlined text-xl">arrow_back</span>
        </a>

        <!-- Restaurant Logo -->
        <div
          class="w-10 h-10 sm:w-12 sm:h-12 shrink-0 bg-white rounded-xl flex items-center justify-center shadow-lg overflow-hidden border border-gray-200 dark:border-gray-700"
        >
          <img
            src="/images/LogoVariante.png"
            th:alt="${config.restaurantName}"
            class="w-full h-full object-contain p-1"
          />
        </div>

        <!-- Title -->
        <div class="flex-1 min-w-0">
          <h1
            class="text-lg sm:text-2xl font-bold text-gray-900 dark:text-white truncate"
            th:text="${config.restaurantName != null && !config.restaurantName.isEmpty()} ? ${config.restaurantName} + ' - Ranking' : 'Ranking de Meseros'"
          >
            Ranking de Meseros
          </h1>
          <p class="text-sm text-gray-600 dark:text-gray-400">
            Top 5 del d√≠a -
            <span th:text="${#temporals.format(rankingDate, 'dd/MM/yyyy')}"
              >29/10/2025</span
            >
          </p>
        </div>
      </header>

      <!-- Main Content -->
      <div
        class="flex-1 overflow-y-auto bg-background-light dark:bg-background-dark"
      >
        <div class="max-w-3xl mx-auto px-4 sm:px-6 py-6 sm:py-8">
          <!-- Check if there are waiters in ranking -->
          <div th:if="${waiterRanking != null && !waiterRanking.isEmpty()}">
            <!-- First Place - Champion -->
            <div
              th:with="champion=${waiterRanking[0]}"
              class="mb-6 sm:mb-8 animate-scaleIn"
            >
              <div
                class="relative rounded-3xl bg-gradient-to-br from-yellow-50 via-yellow-100 to-amber-100 dark:from-yellow-900/20 dark:via-yellow-800/20 dark:to-amber-900/20 border-2 border-yellow-400 dark:border-yellow-600 p-5 sm:p-8 shadow-gold overflow-hidden"
              >
                <!-- Badge Number 1 - Absolute positioning -->
                <div class="absolute top-3 sm:top-4 right-3 sm:right-4 z-10">
                  <div
                    class="w-10 h-10 sm:w-12 sm:h-12 rounded-full bg-yellow-400 flex items-center justify-center shadow-lg"
                  >
                    <span class="text-xl sm:text-2xl font-black text-white"
                      >1</span
                    >
                  </div>
                </div>

                <!-- Content - Centered Layout -->
                <div class="flex flex-col items-center text-center mt-6">
                  <!-- Avatar with Initials -->
                  <div
                    class="w-20 h-20 sm:w-24 sm:h-24 rounded-full bg-gradient-to-br from-yellow-400 to-amber-500 flex items-center justify-center shadow-xl mb-3 sm:mb-4 ring-4 ring-yellow-300 dark:ring-yellow-700"
                  >
                    <span
                      class="text-3xl sm:text-4xl font-black text-white"
                      th:text="${champion.initials}"
                    >
                      AB
                    </span>
                  </div>

                  <!-- Name -->
                  <h2
                    class="text-2xl sm:text-3xl font-black text-gray-900 dark:text-white mb-2"
                  >
                    <span
                      th:text="${champion.employee.nombre} + ' ' + ${champion.employee.apellido}"
                    >
                      Nombre del Mesero
                    </span>
                  </h2>

                  <!-- Title -->
                  <p
                    class="text-base sm:text-lg font-bold text-yellow-700 dark:text-yellow-400 mb-6"
                  >
                    üèÜ Campe√≥n de Ventas
                  </p>

                  <!-- Stats -->
                  <div class="flex gap-4 sm:gap-8 justify-center flex-wrap">
                    <div class="text-center">
                      <p
                        class="text-3xl sm:text-4xl font-black text-primary mb-1"
                      >
                        <span
                          th:text="'$' + ${#numbers.formatDecimal(champion.totalSales, 1, 2)}"
                        >
                          $0.00
                        </span>
                      </p>
                      <p
                        class="text-xs sm:text-sm font-semibold text-gray-600 dark:text-gray-400"
                      >
                        Ventas Totales
                      </p>
                    </div>

                    <div class="text-center">
                      <p
                        class="text-3xl sm:text-4xl font-black text-blue-600 dark:text-blue-400 mb-1"
                      >
                        <span th:text="${champion.totalOrders}">0</span>
                      </p>
                      <p
                        class="text-xs sm:text-sm font-semibold text-gray-600 dark:text-gray-400"
                      >
                        Pedidos Completados
                      </p>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Other Places (2-5) -->
            <div th:if="${waiterRanking.size() > 1}" class="space-y-3">
              <h3
                class="text-lg sm:text-xl font-bold text-gray-900 dark:text-white mb-3 px-2"
              >
                Otros Destacados
              </h3>

              <div
                th:each="waiter, iterStat : ${waiterRanking}"
                th:if="${iterStat.index > 0}"
                class="ranking-item rounded-2xl bg-white dark:bg-surface-dark border border-slate-200 dark:border-slate-800 p-3 sm:p-4 shadow-soft animate-fadeInUp"
                th:style="'animation-delay: ' + ${(iterStat.index + 1) * 0.1} + 's'"
              >
                <div class="flex items-center gap-2 sm:gap-4">
                  <!-- Position Number -->
                  <div class="flex-shrink-0">
                    <div
                      class="w-8 h-8 sm:w-10 sm:h-10 rounded-full flex items-center justify-center font-black text-base sm:text-lg"
                      th:classappend="${iterStat.index == 1} ? 'bg-gray-300 dark:bg-gray-700 text-gray-700 dark:text-gray-300' : 
                                     (${iterStat.index == 2} ? 'bg-amber-700 dark:bg-amber-900 text-amber-100' : 
                                     'bg-slate-300 dark:bg-slate-700 text-slate-700 dark:text-slate-300')"
                    >
                      <span th:text="${iterStat.index + 1}">2</span>
                    </div>
                  </div>

                  <!-- Avatar -->
                  <div class="flex-shrink-0">
                    <div
                      class="w-12 h-12 sm:w-14 sm:h-14 rounded-full bg-gradient-to-br from-primary to-primary-dark flex items-center justify-center shadow-md"
                    >
                      <span
                        class="text-lg sm:text-xl font-black text-white"
                        th:text="${waiter.initials}"
                      >
                        AB
                      </span>
                    </div>
                  </div>

                  <!-- Info -->
                  <div class="flex-1 min-w-0">
                    <h4
                      class="text-base sm:text-lg font-bold text-gray-900 dark:text-white truncate mb-1"
                    >
                      <span
                        th:text="${waiter.employee.nombre} + ' ' + ${waiter.employee.apellido}"
                      >
                        Nombre del Mesero
                      </span>
                    </h4>
                    <!-- Stats - Responsive -->
                    <div
                      class="flex flex-col sm:flex-row sm:items-center sm:gap-4"
                    >
                      <p
                        class="text-xs sm:text-sm text-gray-600 dark:text-gray-400"
                      >
                        <span class="font-semibold text-primary">
                          <span
                            th:text="'$' + ${#numbers.formatDecimal(waiter.totalSales, 1, 2)}"
                          >
                            $0.00
                          </span>
                        </span>
                        <span class="hidden sm:inline"> en ventas</span>
                      </p>
                      <span class="text-gray-400 hidden sm:inline">‚Ä¢</span>
                      <p
                        class="text-xs sm:text-sm text-gray-600 dark:text-gray-400"
                      >
                        <span
                          class="font-semibold"
                          th:text="${waiter.totalOrders}"
                        >
                          0
                        </span>
                        pedidos
                      </p>
                    </div>
                  </div>

                  <!-- Medal Icon - Hidden on small screens -->
                  <div class="flex-shrink-0 hidden sm:block">
                    <span
                      class="material-symbols-outlined filled text-2xl sm:text-3xl"
                      th:classappend="${iterStat.index == 1} ? 'text-gray-400' : 
                                     (${iterStat.index == 2} ? 'text-amber-700 dark:text-amber-600' : 
                                     'text-slate-400')"
                    >
                      military_tech
                    </span>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Empty State -->
          <div
            th:if="${waiterRanking == null || waiterRanking.isEmpty()}"
            class="text-center py-20"
          >
            <div
              class="w-24 h-24 rounded-full bg-gray-100 dark:bg-gray-800 flex items-center justify-center mx-auto mb-6"
            >
              <span
                class="material-symbols-outlined text-6xl text-gray-400 dark:text-gray-600"
              >
                emoji_events
              </span>
            </div>
            <h3 class="text-2xl font-bold text-gray-900 dark:text-white mb-2">
              No hay datos de ranking hoy
            </h3>
            <p class="text-gray-600 dark:text-gray-400">
              A√∫n no hay ventas registradas el d√≠a de hoy para mostrar el
              ranking
            </p>
          </div>
        </div>
      </div>
    </div>
  </body>
</html>
